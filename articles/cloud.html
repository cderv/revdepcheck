<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>cloud • revdepcheck</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="cloud">
<meta property="og:description" content="revdepcheck">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">revdepcheck</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0.0.9001</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/cloud.html">cloud</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/r-lib/revdepcheck/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="cloud_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>cloud</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/r-lib/revdepcheck/blob/master/vignettes/cloud.Rmd"><code>vignettes/cloud.Rmd</code></a></small>
      <div class="hidden name"><code>cloud.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://r-lib.github.io/revdepcheck">revdepcheck</a></span><span class="op">)</span></code></pre></div>
<div id="running-reverse-dependencies-in-the-cloud" class="section level1">
<h1 class="hasAnchor">
<a href="#running-reverse-dependencies-in-the-cloud" class="anchor"></a>Running reverse dependencies in the cloud</h1>
<p>revdepcheck now supports running reverse dependencies in the AWS cloud, via a suite a functions all prefixed with <code>cloud_*()</code>. This service is currently only available to be used by RStudio employees, but we hope to offer this service for the broader R community in the future.</p>
<div id="setup" class="section level2">
<h2 class="hasAnchor">
<a href="#setup" class="anchor"></a>Setup</h2>
<p>Set the <code>RSTUDIO_CLOUD_REVDEP_KEY</code> environment variable to the value of your AWS authentication key, provided to you by RStudio DevOps. Add this key to your <code>.Renviron</code> file with <code>usethis::edit_r_environ()</code> and restart R.</p>
<p>Then install and configure the <code>aws</code> command line tool.</p>
<pre class="shell"><code>brew install awscli
aws configure sso</code></pre>
<p>This will start an interactive process for generating a configuration file in <code>~/.aws/config</code>.</p>
<ul>
<li>You will be asked for an SSO start URL. Enter <a href="https://rstudio.awsapps.com/start" class="uri">https://rstudio.awsapps.com/start</a>.</li>
<li>You will be asked for an SSO Region. Enter us-east-2.</li>
<li>Your browser will open to an Okta single sign on page. Sign in then return to the terminal.</li>
<li>Select RStudio Main as the AWS account (Note that RStudio Tidyverse is not the correct account for this).</li>
<li>Select us-east-1 as the default region (this may already be the default).</li>
<li>Select json as the default output format (this may already be the default).</li>
<li>Specify a profile name, or leave it as TidyverseTeam.</li>
</ul>
<p>Open the newly generated config text file in <code>~/.aws/config</code>. Make the newly generated profile your default by naming it <code>[default]</code> if it isn’t already. Save and close the file.</p>
<p>At this point, the AWS configuration should be complete. However, at irregular intervals AWS may require you to sign in to Okta again. If you run a cloud function that uses the AWS command line interface (like <code><a href="../reference/cloud_status.html">cloud_status()</a></code>) and see an error like:</p>
<pre><code>The SSO session associated with this profile has expired or is otherwise invalid. To refresh this SSO session run aws sso login with the corresponding profile.</code></pre>
<p>then you should open your terminal and run the following:</p>
<pre class="shell"><code>aws sso login</code></pre>
<p>This should open your browser to another Okta single sign on page. After signing in, the cloud function should work again. If you didn’t set the newly created profile as the <code>[default]</code>, then you will need to provide the profile name when running <code>aws sso login</code>.</p>
<p>For more information, look here:</p>
<ul>
<li><a href="https://app.tettra.co/teams/rstudio/pages/aws-single-sign-on#header-ek8lr-interactive-setup">Tettra post on AWS SSO</a></li>
<li><a href="https://www.okta.com/blog/2020/05/how-okta-aws-sso-simplifies-admin-and-adds-cli-support/">Okta post on AWS SSO</a></li>
</ul>
</div>
<div id="usage" class="section level2">
<h2 class="hasAnchor">
<a href="#usage" class="anchor"></a>Usage</h2>
<p><strong>Note</strong> If you are going to be running 500+ tests and are using a development dependency (e.g. <code>Remote: org/pkg</code>) you may exhaust the GitHub API limits. A workaround is to use a ‘url’ remote, e.g. <code>Remote: url::https://github.com/org/pkg/archive/master.tar.gz</code>, which does not use the GitHub API.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Kickoff a new check</span>
<span class="co"># The devel package is automatically built from the current</span>
<span class="co"># working directory, or specify a pre-built package with `tarball`.</span>
<span class="fu"><a href="../reference/cloud_check.html">cloud_check</a></span><span class="op">(</span><span class="op">)</span>

<span class="co"># Follow current status of the job</span>
<span class="fu"><a href="../reference/cloud_status.html">cloud_status</a></span><span class="op">(</span><span class="op">)</span>

<span class="co"># Cancel a job</span>
<span class="fu"><a href="../reference/cloud_cancel.html">cloud_cancel</a></span><span class="op">(</span><span class="op">)</span>

<span class="co"># Retrieve results (if needed) and show a summary</span>
<span class="fu"><a href="../reference/cloud_summary.html">cloud_summary</a></span><span class="op">(</span><span class="op">)</span>

<span class="co"># Retrieve results (if needed) and generate a markdown report</span>
<span class="fu"><a href="../reference/cloud_report.html">cloud_report</a></span><span class="op">(</span><span class="op">)</span>

<span class="co"># Retrieve details of a specfic package</span>
<span class="fu"><a href="../reference/cloud_details.html">cloud_details</a></span><span class="op">(</span>, <span class="st">"pkgXYZ"</span><span class="op">)</span>

<span class="co"># Plot running time for each package in a job</span>
<span class="fu"><a href="../reference/cloud_plot.html">cloud_plot</a></span><span class="op">(</span><span class="op">)</span>

<span class="co"># Email maintainers with failures</span>
<span class="fu"><a href="../reference/cloud_email.html">cloud_email</a></span><span class="op">(</span><span class="op">)</span>

<span class="co"># Retrieve packages that broke in a given job</span>
<span class="fu"><a href="../reference/cloud_broken.html">cloud_broken</a></span><span class="op">(</span><span class="op">)</span>

<span class="co"># Open a web browser to the AWS job pane for the current job</span>
<span class="fu"><a href="../reference/cloud_browse.html">cloud_browse</a></span><span class="op">(</span><span class="op">)</span>

<span class="co"># Open the browser to the AWS job for a particular package</span>
<span class="co"># Useful for debugging why a particular job failed</span>
<span class="fu"><a href="../reference/cloud_browse.html">cloud_browse</a></span><span class="op">(</span>package <span class="op">=</span> <span class="st">"xyz"</span><span class="op">)</span></code></pre></div>
<p>The functions all keep track of the most recently submitted <code>job_id</code>, so assuming you only have one job in a given R session you can call the functions without additional parameters. Provide the <code>job_id</code> explicitly otherwise, results write to <code>revdep/{job_id}</code>.</p>
<p>The <code>cloud_*()</code> functions assume your current working directory is in the root directory of the package you are trying to run reverse dependencies for. If this is not the case all <code>cloud_*()</code> functions take a <code>pkg</code> parameter, so you can specify a different directory if needed.</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Gábor Csárdi, <a href="http://hadley.nz">Hadley Wickham</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
